YUI.add("upstage-permalink",function(a){a.Plugin.UpstagePermalink=a.Base.create("upstage-permalink",a.Plugin.Base,[],{initializer:function(c){var e=this;var f=new a.HistoryHash;var d=c.host;e.afterHostEvent("navigate",function(k){var m=e.get("titleContent");var h=k.details[0];var l=d.indexToId(h);var g;f.addValue("slide",l);if(h==1){g=m;}else{var j=d.get("slides").item(h-1);var i=j.one("h1,h2,h3,h4,h5,h6,p");if(!i){i=j;}if(i){g=i.get("text");}if(!g){g=e.get("strings").slide+" "+h;}g=m+": "+g;}a.one("title").setContent(g);});function b(g){if(g&&g.newVal){g=g.newVal;}else{g=g||1;}g=e._idToIndex(g);if(g&&g!==d.get("currentSlide")){d.set("currentSlide",g);}}f.on("slideChange",b);f.on("slideRemove",b);b(f.get("slide"));},_idToIndex:function(c){var b;if(!isNaN(c)){return c;}this.get("host").get("slides").some(function(e,d){if(e.get("id")===c){return b=d;}});if(b){return b+1;}else{return null;}}},{ATTRS:{strings:{value:{"slide":"Slide"}},titleContent:{value:a.one("title").get("text")}},NS:"permalink"});},"@VERSION@",{requires:["upstage-slideshow","base-build","node","history"]});